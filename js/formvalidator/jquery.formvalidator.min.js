/**
* jQuery Form Validator
* ------------------------------------------
* Created by Victor Jonsson <http://www.victorjonsson.se>
* Documentation and issue tracking on Github <https://github.com/victorjonsson/jQuery-Form-Validator/>
*
* @license Dual licensed under the MIT or GPL Version 2 licenses
* @version 1.9.4
*/(function(a){a.fn.validateOnBlur=function(b,c){return this.find("textarea,input").blur(function(){a(this).doValidate(b,c)}),this},a.fn.showHelpOnFocus=function(b){return b||(b="data-help"),this.find("textarea,input").each(function(){var c=a(this),d=c.attr(b);d&&c.focus(function(){var b=a(this);if(b.parent().find(".jquery_form_help").length==0){var c=a("<span />").addClass("jquery_form_help").text(d).hide().fadeIn();b.after(c)}}).blur(function(){a(this).parent().find(".jquery_form_help").fadeOut("slow",function(){a(this).remove()})})}),this},a.fn.doValidate=function(b,c,d){typeof d=="undefined"&&(d=!0);var e=this,f=document.getElementById(e.attr("name")+"_err_msg"),g={ignore:[],validationRuleAttribute:"data-validation",validationErrorMsgAttribute:"data-validation-error-msg",errorElementClass:"error",borderColorOnError:"red",dateFormat:"yyyy-mm-dd"};c&&a.extend(g,c),b&&a.extend(a.formUtils.LANG,b),b=a.formUtils.LANG;var h=e.attr("type");a.formUtils.defaultBorderColor===null&&h!=="submit"&&h!=="checkbox"&&h!=="radio"&&(a.formUtils.defaultBorderColor=e.css("border-color")),e.removeClass(g.errorElementClass).parent().find(".jquery_form_error_message").remove(),f!=null&&(f.innerHTML=""),g.borderColorOnError!==""&&e.css("border-color",a.formUtils.defaultBorderColor);var i=e.parent();while(i.get(0).nodeName.toLowerCase()!="form")i=i.parent();var j=a.formUtils.validateInput(e,b,g,i);return j===!0?e.addClass("valid"):(e.addClass(g.errorElementClass).removeClass("valid"),f!=null?f.innerHTML=j:e.parent().append('<span class="jquery_form_error_message">'+j+"</span>"),g.borderColorOnError!==""&&e.css("border-color",g.borderColorOnError),d&&e.bind("keyup",function(){a(this).doValidate(b,c,!1)})),this},a.fn.validate=function(b,c){var d={ignore:[],errorElementClass:"error",borderColorOnError:"red",errorMessageClass:"jquery_form_error_message",validationRuleAttribute:"data-validation",validationErrorMsgAttribute:"data-validation-error-msg",errorMessagePosition:"top",scrollToTopOnError:!0,dateFormat:"yyyy-mm-dd"};c&&a.extend(d,c),b&&a.extend(a.formUtils.LANG,b),b=a.formUtils.LANG;var e=function(b){a.inArray(b,f)<0&&f.push(b)},f=[],g=[],h=this,i=function(a,b){if(b==="submit"||b==="button")return!0;for(var c=0;c<d.ignore.length;c++)if(d.ignore[c]===a)return!0;return!1};a.formUtils.haltValidation=!1,h.find("input,textarea,select").each(function(){var c=a(this),j=c.attr("type");if(!i(c.attr("name"),j))if(j==="radio"){var k=c.attr(d.validationRuleAttribute);if(typeof k!="undefined"&&k==="required"){var l=c.attr("name"),m=!1;h.find("input[name="+l+"]").each(function(){if(a(this).is(":checked"))return m=!0,!1});if(!m){var n=c.attr(d.validationErrorMsgAttribute);c.attr("data-validation-current-error",n||b.requiredFields),f.push(n||b.requiredFields),g.push(c)}}}else{a.formUtils.defaultBorderColor===null&&c.attr("type")&&(a.formUtils.defaultBorderColor=c.css("border-color"));var o=a.formUtils.validateInput(c,b,d,h);o!==!0?(g.push(c),e(o),c.attr("data-validation-current-error",o).removeClass("valid")):c.removeAttr("data-validation-current-error").addClass("valid")}});var j=jQueryFormUtils.defaultBorderColor===null||jQueryFormUtils.defaultBorderColor.indexOf(" ")>-1&&jQueryFormUtils.defaultBorderColor.indexOf("rgb")==-1?"border":"border-color";h.find("input,textarea,select").css(j,jQueryFormUtils.defaultBorderColor).removeClass(d.errorElementClass),a("."+d.errorMessageClass.split(" ").join(".")).remove(),a(".jquery_form_error_message").remove();if(!a.formUtils.haltValidation&&g.length>0){for(var k=0;k<g.length;k++)d.borderColorOnError!==""&&g[k].css("border-color",d.borderColorOnError),g[k].addClass(d.errorElementClass);if(d.errorMessagePosition==="top"){var l="<strong>"+b.errorTitle+"</strong>";for(var k=0;k<f.length;k++)l+="<br />* "+f[k];h.children().eq(0).before('<div class="'+d.errorMessageClass+'">'+l+"</div>"),d.scrollToTopOnError&&a(window).scrollTop(h.offset().top-20)}else for(var k=0;k<g.length;k++){var m=g[k].parent(),n=m.find("span[class=jquery_form_error_message]");n.length>0?n.eq(0).text(g[k].attr("data-validation-current-error")):m.append('<span class="jquery_form_error_message">'+g[k].attr("data-validation-current-error")+"</span>")}return!1}return!a.formUtils.haltValidation},a.fn.restrictLength=function(b){return new a.formUtils.lengthRestriction(this,b),this},a.formUtils={defaultBorderColor:null,validators:{},haltValidation:!1,addValidator:function(a){this.validators[a.name]=a},loadModules:function(b,c){var d=function(b,c){a.each(b.split(","),function(b,d){var e=c+a.trim(d)+".js",f=e.substr(-7)!=".dev.js";a.ajax({url:e,cache:e.substr(-7)!=".dev.js",dataType:"script",async:!1,error:function(){throw new Error("Unable to load form validation module "+d)}})})};typeof c!="undefined"?d(b,c):a(function(){var e=a("script");for(var f=0;f<e.length;f++){var g=e.eq(f).attr("src"),h=g.substr(g.lastIndexOf("/")+1,g.length);if(h=="jquery.formvalidator.js"||h=="jquery.formvalidator.min.js"){c=g.substr(0,g.lastIndexOf("/"))+"/",c=="/"&&(c="");break}}d(b,c)})},validateInput:function(b,c,d,e){if(b.get(0).nodeName=="SELECT"&&b.attr("multiple"))return this.validateMultipleSelect(b.val(),b,d,c);var f=a.trim(b.val());f=f||"";var g=b.attr("data-validation-optional"),h=!1,i=!1,j=b.attr("data-validation-if-checked");if(j!=null){h=!0,e||(e=b.closest("form"));var k=e.find('input[name="'+j+'"]');k.prop("checked")&&(i=!0)}if(!f&&g==="true"||h&&!i)return!0;var l=b.attr(d.validationRuleAttribute),m=b.attr(d.validationErrorMsgAttribute);if(typeof l!="undefined"&&l!==null){var n=l.split(" ");for(var o=0;o<n.length;o++){var p=a.formUtils.validators[n[o]];if(typeof p!="undefined"){var q=p.validate(f,b,d,c,e);if(!q)return m||(m=c[p.errorMessageKey],typeof m=="undefined"&&(m=p.errorMessage)),m}else n[o].substr(9)=="validate_"&&typeof console!="undefined"&&"warn"in console&&console.warn('Using undefined validator "'+n[o]+'"')}}return!0},validateMultipleSelect:function(a,b,c,d){a=a||[];var e=b.attr(c.validationRuleAttribute),f=b.attr(c.validationErrorMsgAttribute);if(e.indexOf("validate_num_answers")>-1){var g=this.getAttributeInteger(e,"num");if(g>a.length)return f||d.badNumberOfSelectedOptionsStart+g+d.badNumberOfSelectedOptionsEnd}return!0},getAttributeInteger:function(a,b){var c=new RegExp("("+b+"[0-9-]+)","g");return a.match(c)[0].replace(/[^0-9\-]/g,"")},parseDate:function(b,c){var d=c.replace(/[a-zA-Z]/gi,"").substring(0,1),e="^",f=c.split(d);for(var g=0;g<f.length;g++)e+=(g>0?"\\"+d:"")+"(\\d{"+f[g].length+"})";e+="$";var h=b.match(new RegExp(e));if(h===null)return!1;var i=function(b,c,d){for(var e=0;e<c.length;e++)if(c[e].substring(0,1)===b)return a.formUtils.parseDateInt(d[e+1]);return-1},j=i("m",f,h),k=i("d",f,h),l=i("y",f,h);return j===2&&k>28&&(l%4!==0||l%100===0&&l%400!==0)||j===2&&k>29&&(l%4===0||l%100!==0&&l%400===0)||j>12||j===0?!1:this.isShortMonth(j)&&k>30||!this.isShortMonth(j)&&k>31||k===0?!1:[l,j,k]},parseDateInt:function(a){return a.indexOf("0")===0&&(a=a.replace("0","")),parseInt(a,10)},isShortMonth:function(a){return a%2===0&&a<7||a%2!==0&&a>7},lengthRestriction:function(b,c){function e(){var a=b.val().length;if(a>d){var e=b.scrollTop();b.val(b.val().substring(0,d)),b.scrollTop(e)}c.text(d-a)}var d=parseInt(c.text(),10);a(b).bind("keydown keyup keypress focus blur",e).bind("cut paste",function(){setTimeout(e,100)})},_numSuggestionElements:0,_selectedSuggestion:null,_previousTypedVal:null,suggest:function(b,c,d){var e={css:{maxHeight:"150px",background:"#FFF",lineHeight:"150%",textDecoration:"underline",overflowX:"hidden",overflowY:"auto",cursor:"pointer    "},activeSuggestionCSS:{background:"#F2F2F2"}};return d&&a.extend(e,d),e.css.position="absolute",e.css["z-index"]=9999,b.attr("autocomplete","off"),this._numSuggestionElements++,b.attr("data-validation-suggestion-nr",this._numSuggestionElements).bind("focus",function(){a(this).trigger("keyup"),a.formUtils._selectedSuggestion=null}).bind("keyup",function(){var b=a(this),d=[],f=a.trim(b.val()).toLocaleLowerCase();if(f==a.formUtils._previousTypedVal)return;a.formUtils._previousTypedVal=f;var g=!1,h=b.attr("data-validation-suggestion-nr"),i=a(".jquery-form-suggestion-"+h);i.scrollTop(0),f!=""&&(a.each(c,function(a,b){b.toLocaleLowerCase().indexOf(f)===0&&d.push(b)}),d.length==1&&d[0].length==f.length&&(g=!0)),g||d.length==0&&i.length>0?i.hide():d.length>0&&i.length==0?(i=a("<div></div>").css(e.css).appendTo("body"),i.addClass("jquery-form-suggestions"),i.addClass("jquery-form-suggestion-"+h)):d.length>0&&!i.is(":visible")&&i.show();if(d.length>0&&f.length!=d[0].length){var j=b.offset();i.css({width:b.outerWidth(),left:j.left+"px",top:j.top+b.outerHeight()+"px"}),i.html(""),a.each(d,function(c,d){a("<div></div>").text(d).appendTo(i).click(function(){b.val(a(this).text()).trigger("blur")})})}}).bind("keydown",function(b){var c=b.keyCode?b.keyCode:b.which,d,f,g=a(this);if(c==13&&a.formUtils._selectedSuggestion!==null){d=g.attr("data-validation-suggestion-nr"),f=a(".jquery-form-suggestion-"+d);if(f.length>0)return g.val(f.find("div").eq(a.formUtils._selectedSuggestion).text()).trigger("blur"),b.preventDefault(),!1}else{d=g.attr("data-validation-suggestion-nr"),f=a(".jquery-form-suggestion-"+d);var h=f.children();if(h.length>0&&a.inArray(c,[38,40])>-1){c==38?(a.formUtils._selectedSuggestion===null?a.formUtils._selectedSuggestion=h.length-1:a.formUtils._selectedSuggestion--,a.formUtils._selectedSuggestion<0&&(a.formUtils._selectedSuggestion=h.length-1)):c==40&&(a.formUtils._selectedSuggestion===null?a.formUtils._selectedSuggestion=0:a.formUtils._selectedSuggestion++,a.formUtils._selectedSuggestion>h.length-1&&(a.formUtils._selectedSuggestion=0));var i=f.innerHeight(),j=f.scrollTop(),k=f.children().eq(0).outerHeight(),l=k*a.formUtils._selectedSuggestion;return(l<j||l>j+i)&&f.scrollTop(l),h.removeClass("active-suggestion").css("background","none").eq(a.formUtils._selectedSuggestion).addClass("active-suggestion").css(e.activeSuggestionCSS),b.preventDefault(),!1}}}).bind("blur",function(){var b=a(this).attr("data-validation-suggestion-nr");a.formUtils._selectedSuggestion=null,a.formUtils._previousTypedVal=null,a(".jquery-form-suggestion-"+b).fadeOut("fast")}),b},LANG:{errorTitle:"Form submission failed!",requiredFields:"You have not answered all required fields",badTime:"You have not given a correct time",badEmail:"You have not given a correct e-mail address",badTelephone:"You have not given a correct phone number",badSecurityAnswer:"You have not given a correct answer to the security question",badDate:"You have not given a correct date",toLongStart:"You have given an answer longer than ",toLongEnd:" characters",toShortStart:"You have given an answer shorter than ",toShortEnd:" characters",badLength:"You have to give an answer between ",notConfirmed:"Values could not be confirmed",badDomain:"Incorrect domain value",badUrl:"Incorrect url value",badFloat:"Incorrect float value",badCustomVal:"You gave an incorrect answer",badInt:"Incorrect integer value",badSecurityNumber:"Your social security number was incorrect",badUKVatAnswer:"Incorrect UK VAT Number",badStrength:"The password isn't strong enough",badNumberOfSelectedOptionsStart:"You have to choose at least ",badNumberOfSelectedOptionsEnd:" answers"}},a.formUtils.addValidator({name:"validate_email",validate:function(b){var c=/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(c.test(b)){var d=b.split("@");if(d.length==2)return a.formUtils.validators.validate_domain.validate(d[1])}return!1},errorMessage:"",errorMessageKey:"badEmail"}),a.formUtils.addValidator({name:"validate_domain",validate:function(a){a=a.replace("ftp://","").replace("https://","").replace("http://","").replace("www.","");var b=new Array(".com",".net",".org",".biz",".coop",".info",".museum",".name",".pro",".edu",".gov",".int",".mil",".ac",".ad",".ae",".af",".ag",".ai",".al",".am",".an",".ao",".aq",".ar",".as",".at",".au",".aw",".az",".ba",".bb",".bd",".be",".bf",".bg",".bh",".bi",".bj",".bm",".bn",".bo",".br",".bs",".bt",".bv",".bw",".by",".bz",".ca",".cc",".cd",".cf",".cg",".ch",".ci",".ck",".cl",".cm",".cn",".co",".cr",".cu",".cv",".cx",".cy",".cz",".de",".dj",".dk",".dm",".do",".dz",".ec",".ee",".eg",".eh",".er",".es",".et",".fi",".fj",".fk",".fm",".fo",".fr",".ga",".gd",".ge",".gf",".gg",".gh",".gi",".gl",".gm",".gn",".gp",".gq",".gr",".gs",".gt",".gu",".gv",".gy",".hk",".hm",".hn",".hr",".ht",".hu",".id",".ie",".il",".im",".in",".io",".iq",".ir",".is",".it",".je",".jm",".jo",".jp",".ke",".kg",".kh",".ki",".km",".kn",".kp",".kr",".kw",".ky",".kz",".la",".lb",".lc",".li",".lk",".lr",".ls",".lt",".lu",".lv",".ly",".ma",".mc",".md",".mg",".mh",".mk",".ml",".mm",".mn",".mo",".mp",".mq",".mr",".ms",".mt",".mu",".mv",".mw",".mx",".my",".mz",".na",".nc",".ne",".nf",".ng",".ni",".nl",".no",".np",".nr",".nu",".nz",".om",".pa",".pe",".pf",".pg",".ph",".pk",".pl",".pm",".pn",".pr",".ps",".pt",".pw",".py",".qa",".re",".ro",".rw",".ru",".sa",".sb",".sc",".sd",".se",".sg",".sh",".si",".sj",".sk",".sl",".sm",".sn",".so",".sr",".st",".sv",".sy",".sz",".tc",".td",".tf",".tg",".th",".tj",".tk",".tm",".tn",".to",".tp",".tr",".tt",".tv",".tw",".tz",".ua",".ug",".uk",".um",".us",".uy",".uz",".va",".vc",".ve",".vg",".vi",".vn",".vu",".ws",".wf",".ye",".yt",".yu",".za",".zm",".zw",".me",".mobi",".xxx"),c=a.lastIndexOf("."),d=a.substring(0,c),e=a.substring(c,a.length),f=!1;for(var g=0;g<b.length;g++)if(b[g]===e){if(e!==".uk"){f=!0;break}var h=a.split("."),i=h[h.length-2],j=new Array("co","me","ac","gov","judiciary","ltd","mod","net","nhs","nic","org","parliament","plc","police","sch","bl","british-library","jet","nls");for(var k=0;k<j.length;k++)if(j[k]===i){f=!0;break}if(f)break}if(!f)return!1;if(c<2||c>57)return!1;var l=d.substring(0,1),m=d.substring(d.length-1,d.length);return l==="-"||l==="."||m==="-"||m==="."?!1:d.split(".").length>3||d.split("..").length>1?!1:d.replace(/[0-9a-z\.\-]/g,"")!==""?!1:!0},errorMessage:"",errorMessageKey:"badDomain"}),a.formUtils.addValidator({name:"required",validate:function(a){return a!==""},errorMessage:"",errorMessageKey:"requiredFields"}),a.formUtils.addValidator({name:"validate_min_length",validate:function(b,c,d,e){var f=c.attr(d.validationRuleAttribute),g=a.formUtils.getAttributeInteger(f,"length");return b.length<g?(this.errorMessage=e.toShortStart+g+e.toShortEnd,!1):!0},errorMessage:"",errorMessageKey:""}),a.formUtils.addValidator({name:"validate_max_length",validate:function(b,c,d,e){var f=c.attr(d.validationRuleAttribute),g=a.formUtils.getAttributeInteger(f,"length");return b.length>g?(this.errorMessage=e.toLongStart+g+e.toLongEnd,!1):!0},errorMessage:"",errorMessageKey:""}),a.formUtils.addValidator({name:"validate_length",validate:function(b,c,d,e){var f=c.attr(d.validationRuleAttribute),g=a.formUtils.getAttributeInteger(f,"length"),h=g.split("-");return b.length<parseInt(h[0],10)||b.length>parseInt(h[1],10)?(this.errorMessage=e.badLength+g+e.toLongEnd,!1):!0},errorMessage:"",errorMessageKey:""}),a.formUtils.addValidator({name:"validate_url",validate:function(b){var c=/^(https|http|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|\[|\]|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;if(c.test(b)){var d=b.split(/^https|^http|^ftp/i)[1].replace("://",""),e=d.indexOf("/");return e>-1&&(d=d.substr(0,e)),a.formUtils.validators.validate_domain.validate(d)}return!1},errorMessage:"",errorMessageKey:"badUrl"}),a.formUtils.addValidator({name:"validate_number",validate:function(b){return a.formUtils.validators.validate_int.validate(b)||a.formUtils.validators.validate_float.validate(b)},errorMessage:"",errorMessageKey:"badInt"}),a.formUtils.addValidator({name:"validate_custom",validate:function(a,b,c){var d=b.attr(c.validationRuleAttribute),e=new RegExp(d.split("regexp/")[1].split("/")[0]);return e.test(a)},errorMessage:"",errorMessageKey:"badCustomVal"}),a.formUtils.addValidator({name:"validate_int",validate:function(a){return a!==""&&a.replace(/[0-9]/g,"")===""},errorMessage:"",errorMessageKey:"badInt"}),a.formUtils.addValidator({name:"validate_float",validate:function(a){return a.match(/^(\-|)([0-9]+)\.([0-9]+)$/)!==null},errorMessage:"",errorMessageKey:"badFloat"}),a.formUtils.addValidator({name:"validate_date",validate:function(b,c,d){var e="yyyy-mm-dd";return c.attr("data-format")?e=c.attr("data-format"):typeof d.dateFormat!="undefined"&&(e=d.dateFormat),a.formUtils.parseDate(b,e)!==!1},errorMessage:"",errorMessageKey:"badDate"}),a.formUtils.addValidator({name:"validate_phone",validate:function(a){var b=a.match(/\+/g),c=a.match(/-/g);return b!==null&&b.length>1||c!==null&&c.length>1?!1:b!==null&&a.indexOf("+")!==0?!1:(a=a.replace(/([-|\+])/g,""),a.length>8&&a.match(/[^0-9]/g)===null)},errorMessage:"",errorMessageKey:"badTelephone"})})(jQuery);